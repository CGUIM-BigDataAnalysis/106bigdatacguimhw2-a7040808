Q5<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
View(Q5)
group_by(Q5,國別) %>%
summarise(total=sum(小計))
View(Q5)
a<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
a<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
View(Q5)
a<-group_by(Q5,國別) %>%
summarise(total=sum(`小計`))
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(`小計`))
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(`小計`))
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
View(a)
View(a)
kable(head(a[order(a$total,decreasing = TRUE),],10))
kable(head(a[order(a$total,decreasing = TRUE),],10))
View(Q5)
### 哪間大學的出國交流學生數最多呢？
b<-group_by(Q5,學校名稱) %>%
summarise(total=sum(小計))
View(b)
kable(head(b[order(b$total,decreasing = TRUE),],10))
kable(head(b[order(b$total,decreasing = TRUE),],10))
### 台灣大專院校的學生最喜歡去哪些國家進修交流條狀圖
ggplot(data=a)+
geom_bar(aes(x=國別,y=total),stat="identity")
### 台灣大專院校的學生最喜歡去哪些國家進修交流條狀圖
ggplot(data=a)+
geom_bar(aes(x=國別,y=total),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
### 台灣大專院校的學生最喜歡去哪些國家進修交流條狀圖
ggplot(data=a)+
geom_bar(aes(x=國別,y=total),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(Q5)
View(code)
### 台灣大專院校的學生最喜歡去哪些國家進修交流面量圖
Q7<-left_join(Q5,code,by="國別")
View(Q7)
Q7<-left_join(country.map,Q7,by="ISO")
View(Q7)
Q7[is.na(Q7)]<-0
Q7map<-ggplot() +
geom_polygon(data = Q7,
aes(x = long, y = lat,
group = Group,
fill = 小計),
color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-180, 180) ,ylim = c(-90, 90))+#維持地圖比例
scale_fill_gradientn(colours = brewer.pal(7,"Reds"))+
theme_void()+
labs(fill="單位(人)",title = "各國來台留學生面量圖")
Q7map
View(Q7)
Q7map<-ggplot() +
geom_polygon(data = Q7,
aes(x = long, y = lat,
group = Group,
fill = 小計),
color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-180, 180) ,ylim = c(-90, 90))+#維持地圖比例
scale_fill_gradientn(colours = brewer.pal(7,"Reds"))+
theme_void()+
labs(fill="單位(人)",title = "台灣學生進修交流國家")
Q7map
View(Q7)
Q7map<-ggplot() +
geom_polygon(data = Q7,
aes(x = long, y = lat,
group = Group,
fill = 小計),
color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-180, 180) ,ylim = c(-90, 90))+#維持地圖比例
scale_fill_gradientn(colours = brewer.pal(9,"Reds"))+
theme_void()+
labs(fill="單位(人)",title = "台灣學生進修交流國家")
Q7map
View(Q7)
Q7map<-ggplot() +
geom_polygon(data = Q7,
aes(x = long, y = lat,
group = Group,
fill = `小計`),
color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-180, 180) ,ylim = c(-90, 90))+#維持地圖比例
scale_fill_gradientn(colours = brewer.pal(9,"Reds"))+
theme_void()+
labs(fill="單位(人)",title = "台灣學生進修交流國家")
Q7map
View(Q7)
View(Q7)
View(Q5)
View(a)
View(b)
View(a)
### 台灣大專院校的學生最喜歡去哪些國家進修交流面量圖
Q7<-left_join(a,code,by="國別")
Q7<-left_join(country.map,Q7,by="ISO")
Q7[is.na(Q7)]<-0
Q7map<-ggplot() +
geom_polygon(data = Q7,
aes(x = long, y = lat,
group = Group,
fill = `小計`),
color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-180, 180) ,ylim = c(-90, 90))+#維持地圖比例
scale_fill_gradientn(colours = brewer.pal(9,"Reds"))+
theme_void()+
labs(fill="單位(人)",title = "台灣學生進修交流國家")
Q7map
View(Q7)
Q7map<-ggplot() +
geom_polygon(data = Q7,
aes(x = long, y = lat,
group = Group,
fill = `小計`),
color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-180, 180) ,ylim = c(-90, 90))+#維持地圖比例
scale_fill_gradientn(colours = brewer.pal(9,"Reds"))+
theme_void()+
labs(fill="單位(人)",title = "台灣學生進修交流國家")
Q7map
View(Q7)
Q7map<-ggplot() +
geom_polygon(data = Q7,
aes(x = long, y = lat,
group = Group,
fill = total),
color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-180, 180) ,ylim = c(-90, 90))+#維持地圖比例
scale_fill_gradientn(colours = brewer.pal(9,"Reds"))+
theme_void()+
labs(fill="單位(人)",title = "台灣學生進修交流國家")
Q7map
### 台灣學生最喜歡去哪些國家留學呢？
b<-ComPop[-grep("進",ComPop$學制),]
b<-ComPop[-grep("進",ComPop$學制),]
kable(head(b[order(b$總人數,decreasing = TRUE),],10))
b<-ComPop[-grep("進",ComPop$學制),]
kable(head(b[order(b$總人數,decreasing = TRUE),],10))
View(b)
View(IS)
View(Q1)
## 綜合分析
Q1<-head(Q1[order(Q1$total,decreasing = TRUE),],10)
View(Q1)
Q1_103<-data.frame(Statisticscon103$國別,rowSums(Statisticscon103[3:11]))
names(Q1_103)<-c("國別","total")
Q1_103$total<-as.numeric(Q1_103$total)
Q1_104<-data.frame(Statisticscon104$國別,rowSums(Statisticscon104[3:11]))
names(Q1_104)<-c("國別","total")
Q1_104$total<-as.numeric(Q1_104$total)
Q1_105<-data.frame(Statisticscon105$國別,rowSums(Statisticscon105[3:11]))
names(Q1_105)<-c("國別","total")
Q1_105$total<-as.numeric(Q1_105$total)
Q1_106<-data.frame(Statisticscon106$國別,rowSums(Statisticscon106[3:11]))
names(Q1_106)<-c("國別","total")
Q1_106$total<-as.numeric(Q1_106$total)
Q1<-full_join(Q1_103,Q1_104,by ="國別")
Q1<-full_join(Q1,Q1_105,by ="國別")
Q1<-full_join(Q1,Q1_106,by ="國別")
Q1[is.na(Q1)]<-0
Q1<-data.frame(Q1$國別,rowSums(Q1[,2:5]))
names(Q1)<-c("國別","total")
kable(head(Q1[order(Q1$total,decreasing = TRUE),],10))
## 綜合分析
Q1<-head(Q1[order(Q1$total,decreasing = TRUE),])
View(Q1)
Q1_103<-data.frame(Statisticscon103$國別,rowSums(Statisticscon103[3:11]))
names(Q1_103)<-c("國別","total")
Q1_103$total<-as.numeric(Q1_103$total)
Q1_104<-data.frame(Statisticscon104$國別,rowSums(Statisticscon104[3:11]))
names(Q1_104)<-c("國別","total")
Q1_104$total<-as.numeric(Q1_104$total)
Q1_105<-data.frame(Statisticscon105$國別,rowSums(Statisticscon105[3:11]))
names(Q1_105)<-c("國別","total")
Q1_105$total<-as.numeric(Q1_105$total)
Q1_106<-data.frame(Statisticscon106$國別,rowSums(Statisticscon106[3:11]))
names(Q1_106)<-c("國別","total")
Q1_106$total<-as.numeric(Q1_106$total)
Q1<-full_join(Q1_103,Q1_104,by ="國別")
Q1<-full_join(Q1,Q1_105,by ="國別")
Q1<-full_join(Q1,Q1_106,by ="國別")
Q1[is.na(Q1)]<-0
Q1<-data.frame(Q1$國別,rowSums(Q1[,2:5]))
names(Q1)<-c("國別","total")
kable(head(Q1[order(Q1$total,decreasing = TRUE),],10))
## 綜合分析
Q9a<-head(Q1[order(Q1$total,decreasing = TRUE),],30)
View(Q9a)
Q9b<-head(IS[order(IS$總人數,decreasing = TRUE),],30)
View(Q9b)
## 綜合分析
Q9a<-head(Q1[order(Q1$total,decreasing = TRUE),],25)
Q9b<-head(IS[order(IS$總人數,decreasing = TRUE),],25)
View(Q9a)
View(Q9b)
Q9b<-head(IS[order(IS$總人數,decreasing = TRUE),],30)
View(IS)
## 綜合分析
Q9a<-head(Q1[order(Q1$total,decreasing = TRUE),],29)
Q9b<-head(IS[order(IS$總人數,decreasing = TRUE),],29)
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
View(Q9a)
View(Q9b)
Q9<-left_join(Q9b,Q9a,by=國別)
Q9<-left_join(Q9b,Q9a,by=國別)
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
View(Q9a)
names(Q9a)<-c("國別","外國人來台")
View(Q9a)
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
View(Q9b)
Q9b<-Q9b[,-1]
View(Q9b)
names(Q9b)<-c("國別","台灣人出國")
View(Q9b)
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
View(Q9a)
Q9a[7,1]<-"韓國"
View(Q9a)
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a[7,1]
View(Q9a)
Q9a[8,1]
Q9a[8,1]<-"韓國"
View(Q9a)
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
View(Q9a)
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
View(Q9)
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
View(Q9)
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
library(dplyr)
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
library(tidyr)
install.packages("tidyr")
library(tidyr)
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
View(Q9)
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
View(Q9)
View(Q9)
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
View(Q9)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total),stat="identity",fill=Type)+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total),stat="identity",fill=Type)+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(Q9)
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total),stat="identity",fill=Type)+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
View(Q9b)
View(Q9a)
View(Q1)
View(IS)
## 綜合分析
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
View(Q9a)
## 綜合分析
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
View(Q9a)
## 綜合分析
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(Q9a)
View(Q9b)
View(Q9)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type,position=position_dodge(width = 0.8)),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type,position=position_dodge(width = 0.8)),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type,stat="identity",position=position_dodge(width = 0.8)))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type,stat="identity",position=position_dodge(width = 0.8)))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(ComPop)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 0.8))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 1))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 0.8))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
Q5$國別<-gsub("中國大陸|大陸地區","中國",Q5$國別)
View(Q5)
Q5$國別[grepl("大韓民國",Q5$國別)]<-"韓國"
Q5$國別<-gsub("南韓","韓國",Q5$國別)
Q5$國別<-gsub("澳大利亞","澳洲",Q5$國別)
Q5$國別<-gsub("德意志聯邦共和國","德國",Q5$國別)
Q5$國別<-gsub("甘比亞共和國","甘比亞",Q5$國別)
Q5$國別<-gsub("菲律賓共和國","菲律賓",Q5$國別)
Q5$國別<-gsub("印度尼西亞共和國","印尼",Q5$國別)
Q5$國別<-gsub("荷蘭王國","荷蘭",Q5$國別)
Q5$國別<-gsub("捷克共和國","捷克",Q5$國別)
Q5$國別[grepl("泰王國",Q5$國別)]<-"泰國"
Q5$國別<-gsub("俄羅斯聯邦","俄羅斯",Q5$國別)
Q5$國別<-gsub("西班牙王國","西班牙",Q5$國別)
View(Q5)
a<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
View(a)
View(IS)
View(a)
View(a)
a<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
View(a)
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
a<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(`小計`))
View(a)
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(`小計`))
View(Q5)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum("小計"))
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
View(Q5)
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
Q5$小計<-as.numeric(Q5$小計)
Q5$國別<-gsub("中國大陸|大陸地區","中國",Q5$國別)
Q5$國別[grepl("大韓民國",Q5$國別)]<-"韓國"
Q5$國別<-gsub("南韓","韓國",Q5$國別)
Q5$國別<-gsub("澳大利亞","澳洲",Q5$國別)
Q5$國別<-gsub("德意志聯邦共和國","德國",Q5$國別)
Q5$國別<-gsub("甘比亞共和國","甘比亞",Q5$國別)
Q5$國別<-gsub("菲律賓共和國","菲律賓",Q5$國別)
Q5$國別<-gsub("印度尼西亞共和國","印尼",Q5$國別)
Q5$國別<-gsub("荷蘭王國","荷蘭",Q5$國別)
Q5$國別<-gsub("捷克共和國","捷克",Q5$國別)
Q5$國別[grepl("泰王國",Q5$國別)]<-"泰國"
Q5$國別<-gsub("俄羅斯聯邦","俄羅斯",Q5$國別)
Q5$國別<-gsub("西班牙王國","西班牙",Q5$國別)
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
Q5$國別<-gsub("瑞典王國","瑞典",Q5$國別)
Q5$國別[grepl("泰王國",Q5$國別)]<-"泰國"
Q5$國別<-gsub("俄羅斯聯邦","俄羅斯",Q5$國別)
Q5$國別<-gsub("西班牙王國","西班牙",Q5$國別)
Q5$國別<-gsub("新加坡共和國","新加坡",Q5$國別)
Q5$國別<-gsub("奧地利共和國","奧地利",Q5$國別)
Q5$國別<-gsub("瑞典王國","瑞典",Q5$國別)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
kable(head(Q5[order(Q5$total,decreasing = TRUE),],10))
View(a)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 0.8))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(IS)
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 0.8))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
