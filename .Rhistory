View(IS)
## 綜合分析
Q9a<-head(Q1[order(Q1$total,decreasing = TRUE),],29)
Q9b<-head(IS[order(IS$總人數,decreasing = TRUE),],29)
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
View(Q9a)
View(Q9b)
Q9<-left_join(Q9b,Q9a,by=國別)
Q9<-left_join(Q9b,Q9a,by=國別)
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
View(Q9a)
names(Q9a)<-c("國別","外國人來台")
View(Q9a)
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
View(Q9b)
Q9b<-Q9b[,-1]
View(Q9b)
names(Q9b)<-c("國別","台灣人出國")
View(Q9b)
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
View(Q9a)
Q9a[7,1]<-"韓國"
View(Q9a)
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a[7,1]
View(Q9a)
Q9a[8,1]
Q9a[8,1]<-"韓國"
View(Q9a)
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
View(Q9a)
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
View(Q9)
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
View(Q9)
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
library(dplyr)
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
library(tidyr)
install.packages("tidyr")
library(tidyr)
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
View(Q9)
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=Value,台灣人出國,外國人來台)
View(Q9)
View(Q9)
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
View(Q9)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total),stat="identity",fill=Type)+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total),stat="identity",fill=Type)+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(Q9)
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total),stat="identity",fill=Type)+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
## 綜合分析
Q9a<-Q1[order(Q1$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
View(Q9)
View(Q9b)
View(Q9a)
View(Q1)
View(IS)
## 綜合分析
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
View(Q9a)
## 綜合分析
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
View(Q9a)
## 綜合分析
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(Q9a)
View(Q9b)
View(Q9)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type,position=position_dodge(width = 0.8)),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type,position=position_dodge(width = 0.8)),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type,stat="identity",position=position_dodge(width = 0.8)))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type,stat="identity",position=position_dodge(width = 0.8)))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(ComPop)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 0.8))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 1))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 0.8))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
Q5$國別<-gsub("中國大陸|大陸地區","中國",Q5$國別)
View(Q5)
Q5$國別[grepl("大韓民國",Q5$國別)]<-"韓國"
Q5$國別<-gsub("南韓","韓國",Q5$國別)
Q5$國別<-gsub("澳大利亞","澳洲",Q5$國別)
Q5$國別<-gsub("德意志聯邦共和國","德國",Q5$國別)
Q5$國別<-gsub("甘比亞共和國","甘比亞",Q5$國別)
Q5$國別<-gsub("菲律賓共和國","菲律賓",Q5$國別)
Q5$國別<-gsub("印度尼西亞共和國","印尼",Q5$國別)
Q5$國別<-gsub("荷蘭王國","荷蘭",Q5$國別)
Q5$國別<-gsub("捷克共和國","捷克",Q5$國別)
Q5$國別[grepl("泰王國",Q5$國別)]<-"泰國"
Q5$國別<-gsub("俄羅斯聯邦","俄羅斯",Q5$國別)
Q5$國別<-gsub("西班牙王國","西班牙",Q5$國別)
View(Q5)
a<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
View(a)
View(IS)
View(a)
View(a)
a<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
View(a)
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
a<-group_by(Q5,國別) %>%
summarise(total=sum(小計))
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(`小計`))
View(a)
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(`小計`))
View(Q5)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum("小計"))
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
View(Q5)
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
Q5$小計<-as.numeric(Q5$小計)
Q5$國別<-gsub("中國大陸|大陸地區","中國",Q5$國別)
Q5$國別[grepl("大韓民國",Q5$國別)]<-"韓國"
Q5$國別<-gsub("南韓","韓國",Q5$國別)
Q5$國別<-gsub("澳大利亞","澳洲",Q5$國別)
Q5$國別<-gsub("德意志聯邦共和國","德國",Q5$國別)
Q5$國別<-gsub("甘比亞共和國","甘比亞",Q5$國別)
Q5$國別<-gsub("菲律賓共和國","菲律賓",Q5$國別)
Q5$國別<-gsub("印度尼西亞共和國","印尼",Q5$國別)
Q5$國別<-gsub("荷蘭王國","荷蘭",Q5$國別)
Q5$國別<-gsub("捷克共和國","捷克",Q5$國別)
Q5$國別[grepl("泰王國",Q5$國別)]<-"泰國"
Q5$國別<-gsub("俄羅斯聯邦","俄羅斯",Q5$國別)
Q5$國別<-gsub("西班牙王國","西班牙",Q5$國別)
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
Q5$國別<-gsub("瑞典王國","瑞典",Q5$國別)
Q5$國別[grepl("泰王國",Q5$國別)]<-"泰國"
Q5$國別<-gsub("俄羅斯聯邦","俄羅斯",Q5$國別)
Q5$國別<-gsub("西班牙王國","西班牙",Q5$國別)
Q5$國別<-gsub("新加坡共和國","新加坡",Q5$國別)
Q5$國別<-gsub("奧地利共和國","奧地利",Q5$國別)
Q5$國別<-gsub("瑞典王國","瑞典",Q5$國別)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
kable(head(Q5[order(Q5$total,decreasing = TRUE),],10))
View(a)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 0.8))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(IS)
Q9a<-Q1_105[order(Q1_105$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 0.8))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
View(Q5)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
View(a)
Q5<-full_join(Q5,a,by="國別")
View(Q5)
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q5<-full_join(a,code,by="國別")
View(Q5)
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q5<-full_join(a,code,by="國別")
library(readr)
library(knitr)
library(ggplot2)
library(dplyr)
library(choroplethr)
library(choroplethrMaps)
library(RColorBrewer)
library(tidyr)
### 台灣大專院校的學生最喜歡去哪些國家進修交流呢？
Q5<-ComPop
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q5<-full_join(a,code,by="國別")
View(Q5)
View(Q5)
Q5[grep("[A-Z]{3}",Q5$ISO,invert=T),]
Q5<-ComPop
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q5<-full_join(a,code,by="國別")
Q5[grep("[A-Z]{3}",Q5$ISO,invert=T),]
Q5<-Q5[order(Q5$total),]
View(Q5)
Q5<-Q5[order(Q5$total,decreasing = T),]
View(Q5)
Q5[grep("[A-Z]{3}",Q5$ISO,invert=T),]
View(Q5)
Q5[grep("[A-Z]{3}",Q5$ISO,invert=T),]
View(Q5)
View(code)
View(Q5)
View(Q1_105)
View(Q1_105)
Q5$ISO[grep("[A-Z]{3}",Q5$ISO,invert=T)]<-c("CHN","CHN","KOR","KOR","DEU","AUS","THA","SGP","ESP","NLD",
"CZE","AUT","RUS","SWE","PHL","BEL","IDN","VNM","FIN","ITA")
View(Q5)
View(Q5)
kable(head(Q5[order(Q5$total,decreasing = TRUE),],10))
Q5$ISO[grep("[A-Z]{3}",Q5$ISO,invert=T)]<-c("CHN","CHN","KOR","KOR","DEU","AUS","THA","SGP","ESP","NLD",
"CZE","AUT","RUS","SWE","PHL","BEL","IDN","VNM","FIN","ITA")
kable(head(Q5[order(Q5$total,decreasing = TRUE),],10))
View(Q5)
Q5<-group_by(Q5,ISO) %>% summarise(total = sum(total))
View(Q5)
Q5<-ComPop
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q5<-full_join(a,code,by="國別")
Q5<-Q5[order(Q5$total,decreasing = T),]
Q5[grep("[A-Z]{3}",Q5$ISO,invert=T),]
Q5$ISO[grep("[A-Z]{3}",Q5$ISO,invert=T)]<-c("CHN","CHN","KOR","KOR","DEU","AUS","THA","SGP","ESP","NLD",
"CZE","AUT","RUS","SWE","PHL","BEL","IDN","VNM","FIN","ITA")
View(Q5)
Q5<-group_by(Q5,ISO) %>% summarise(total = sum(total))
View(Q5)
Q5<-ComPop
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q5<-full_join(a,code,by="國別")
Q5<-Q5[order(Q5$total,decreasing = T),]
Q5[grep("[A-Z]{3}",Q5$ISO,invert=T),]
Q5$ISO[grep("[A-Z]{3}",Q5$ISO,invert=T)]<-c("CHN","CHN","KOR","KOR","DEU","AUS","THA","SGP","ESP","NLD",
"CZE","AUT","RUS","SWE","PHL","BEL","IDN","VNM","FIN","ITA")
View(Q5)
Q5<-group_by(Q5,ISO) %>% summarise(total = sum(total))
View(Q5)
Q5<-ComPop
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q5<-full_join(a,code,by="國別")
Q5<-Q5[order(Q5$total,decreasing = T),]
Q5[grep("[A-Z]{3}",Q5$ISO,invert=T),]
Q5$ISO[grep("[A-Z]{3}",Q5$ISO,invert=T)]<-c("CHN","CHN","KOR","KOR","DEU","AUS","THA","SGP","ESP","NLD",
"CZE","AUT","RUS","SWE","PHL","BEL","IDN","VNM","FIN","ITA")
View(Q5)
Q5<-group_by(Q5,ISO) %>% summarise(total = sum(total,na.rm=T))
Q5<-ComPop
Q5$小計<-as.numeric(Q5$小計)
a<-group_by(Q5,`國別`) %>%
summarise(total=sum(小計))
Q5<-full_join(a,code,by="國別")
Q5<-Q5[order(Q5$total,decreasing = T),]
Q5[grep("[A-Z]{3}",Q5$ISO,invert=T),]
Q5$ISO[grep("[A-Z]{3}",Q5$ISO,invert=T)]<-c("CHN","CHN","KOR","KOR","DEU","AUS","THA","SGP","ESP","NLD",
"CZE","AUT","RUS","SWE","PHL","BEL","IDN","VNM","FIN","ITA")
View(Q5)
Q5<-group_by(Q5,ISO) %>% summarise(total = sum(total,na.rm=T))
View(Q5)
kable(head(Q5[order(Q5$total,decreasing = TRUE),],10))
kable(head(Q5[order(Q5$total,decreasing = TRUE),],10))
View(Q5)
View(Q5)
View(ComPop)
### 哪間大學的出國交流學生數最多呢？
Q6<-group_by(ComPop,學校名稱) %>%
summarise(total=sum(小計))
### 哪間大學的出國交流學生數最多呢？
Q6<-group_by(ComPop,學校名稱) %>%
summarise(total=sum(小計))
### 哪間大學的出國交流學生數最多呢？
ComPop$小計<-as.numeric(ComPop$小計)
Q6<-group_by(ComPop,學校名稱) %>%
summarise(total=sum(小計))
View(Q6)
kable(head(Q6[order(Q6$total,decreasing = TRUE),],10))
kable(head(Q6[order(Q6$total,decreasing = TRUE),],10))
View(Q5)
### 台灣大專院校的學生最喜歡去哪些國家進修交流條狀圖
others2<-c("其他",sum(filter(Q5,total<200)$total))
Q6b<-rbind(filter(Q5,total>=200),others2)
Q6b$total<-as.numeric(Q6b$total)
View(Q6b)
View(Q6b)
ggplot(data=Q6b)+
geom_bar(aes(x=ISO,y=total),stat="identity")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
View(Q7)
### 台灣大專院校的學生最喜歡去哪些國家進修交流面量圖
Q7<-left_join(a,code,by="國別")
View(Q7)
### 台灣大專院校的學生最喜歡去哪些國家進修交流面量圖
Q7<-left_join(country.map,Q5,by="ISO")
Q7[is.na(Q7)]<-0
View(Q7)
View(Q7)
Q7map<-ggplot() +
geom_polygon(data = Q7,
aes(x = long, y = lat,
group = Group,
fill = total),
color = "black",
size = 0.25,
na.rm = T) +
coord_cartesian(xlim = c(-180, 180) ,ylim = c(-90, 90))+#維持地圖比例
scale_fill_gradientn(colours = brewer.pal(9,"Reds"))+
theme_void()+
labs(fill="單位(人)",title = "台灣學生進修交流國家")
Q7map
View(Q1_105)
View(Statisticscol105)
View(Statisticscol106)
View(Statisticscol105)
View(Statisticscon105)
## 綜合分析
Q1_105a<-data.frame(Statisticscon105$國別,rowSums(Statisticscon105[3:5]))
names(Q1_105)<-c("國別","total")
names(Q1_105a)<-c("國別","total")
Q1_105a$total<-as.numeric(Q1_105a$total)
Q9a<-Q1_105a[order(Q1_105a$total,decreasing = TRUE),]
View(Q1_105a)
Q9a<-Q1_105a[order(Q1_105a$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
Q9a[8,1]<-"韓國"
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
## 綜合分析
Q1_105a<-data.frame(Statisticscon105$國別,rowSums(Statisticscon105[3:5]))
names(Q1_105a)<-c("國別","total")
Q1_105a$total<-as.numeric(Q1_105a$total)
Q9a<-Q1_105a[order(Q1_105a$total,decreasing = TRUE),]
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
View(Q9a)
## 綜合分析
Q1_105a<-data.frame(Statisticscon105$國別,rowSums(Statisticscon105[3:5]))
names(Q1_105a)<-c("國別","total")
Q1_105a$total<-as.numeric(Q1_105a$total)
## 綜合分析
Q1_105a<-data.frame(Statisticscon105$國別,rowSums(Statisticscon105[3:5]))
names(Q1_105a)<-c("國別","total")
Q1_105a$total<-as.numeric(Q1_105a$total)
View(Q1_105a)
Q9a<-Q1_105a[order(Q1_105a$total,decreasing = TRUE),]
View(Q9a)
View(Q9a)
names(Q9a)<-c("國別","外國人來台")
Q9a$國別<-as.character(Q9a$國別)
View(Q9a)
Q9a[9,1]<-"韓國"
View(Q9a)
Q9b<-IS[order(IS$總人數,decreasing = TRUE),]
Q9b<-Q9b[,-1]
names(Q9b)<-c("國別","台灣人出國")
Q9<-left_join(Q9b,Q9a,by="國別")
Q9$國別 <- factor(Q9$國別, levels = Q9$國別[order(desc(Q9$台灣人出國))])
Q9<-gather(Q9,
key=Type,value=total,台灣人出國,外國人來台)
ggplot(data=Q9)+
geom_bar(aes(x=國別,y=total,fill=Type),stat="identity",position=position_dodge(width = 0.8))+
theme(axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5))
